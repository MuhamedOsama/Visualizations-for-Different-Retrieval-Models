<!DOCTYPE html>
<html>

<head>
    <link href='../assets/fonts/Icons.css' rel="stylesheet">
    <link href="../assets/css/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
</head>

<body>
    <v-app id="app">
        <v-container>
            <v-layout row wrap align-center style="justify-content: center;align-items:center;">
                <v-flex xs6 class="text-xs-center">
                    <v-form v-model="form">
                        <v-flex mt-4>
                        </v-flex>
                        <v-flex mat4>
                            <v-textarea v-model="CurrentDocumentContent" auto-grow box :rules="DocumentContentRule"
                                color="deep-purple" label="Document text" rows="2"></v-textarea>
                        </v-flex>
                        <v-flex mt-3>
                            <v-btn class="red" dark large @click="handleNewDoc()">
                                Add Document
                            </v-btn>
                        </v-flex>
                    </v-form>
                </v-flex>
                <v-flex xs12></v-flex>
                <v-flex xs6 class="text-xs-center">
                    <div class="font-weight-thin display-3 mb-2 mt-2">Documents</div>
                    <v-flex v-if="!Documents.length" class="font-weight-thin display-1">No Documents to Show</v-flex>
                    <v-flex v-else>
                        <template v-for="(item,i) in this.Documents">
                            <v-card class="red lighten-4">
                                <v-flex class="ma-2">
                                    <div class="display-2">{{item.Name}}</div>
                                    <v-list-tile>
                                        <v-list-tile-content>
                                            {{item.Content}}
                                        </v-list-tile-content>
                                    </v-list-tile>
                                </v-flex>
                            </v-card>
                        </template>
                    </v-flex>
                    </div>
                </v-flex>
                <v-flex xs12></v-flex>
                <v-flex mt-3 class="text-xs-center">
                    <v-btn class="black" dark large @click="calc_IDF()">
                        Calculate idf
                    </v-btn>
                    <v-btn class="black" dark large @click="">
                        Calculate tf
                    </v-btn>
                    <v-btn class="black" dark large @click="">
                        Calculate tf*idf
                    </v-btn>
                </v-flex>
                <v-flex xs12></v-flex>
                <v-flex xs6 class="text-xs-center">
                    <div class="font-weight-thin display-3 mb-2 mt-2">IDF For Each Word</div>
                    <v-flex v-if="!idfCalc" class="font-weight-thin display-1">IDFs not Calculated</v-flex>
                    <v-flex v-else>
                        <template v-for="(item,i) in this.wordsList">
                            <v-card class="blue lighten-4">
                                <v-flex class="ma-2">
                                    <v-list-tile>
                                        <v-list-tile-content>
                                            {{item.termName}} idf = log10({{Documents.length}}/{{item.termDublications}}) = {{item.idf}}
                                        </v-list-tile-content>
                                    </v-list-tile>
                                </v-flex>
                            </v-card>
                        </template>
                    </v-flex>
                    </div>
                </v-flex>
                <v-flex xs12></v-flex>
                <div class="font-weight-thin display-3 mb-2 mt-2">Enter Query</div>
                <v-flex xs12></v-flex>
                <v-flex xs6 class="text-xs-center">
                    <v-text-field @change="" v-model="QueryText" label="Enter a Query" :rules="QueryRule" clearable
                        auto-grow box mt-4></v-text-field>
                </v-flex>
                <v-flex xs12></v-flex>
                <v-flex xs6 class="text-xs-center">
                    <v-btn class="Blue" dark large @click="">
                        Go
                    </v-btn>
                </v-flex>
                <v-flex xs12></v-flex>
                <v-flex xs6 class="text-xs-center">
                    <div class="display-2">Query Results</div>
                    <div v-for="item in result">
                        <span> </span>
                        <h3>{{item}}</h3>
                    </div>
                </v-flex>
                <v-flex xs12></v-flex>
                <v-flex mt-3 class="text-xs-center">
                    <v-btn class="black" dark large @click="">
                        Calculate sim
                    </v-btn>
                    <v-btn class="black" dark large @click="">
                        Calculate cossim
                    </v-btn>
                </v-flex>
                <v-flex xs12></v-flex>
            </v-layout>


        </v-container>

    </v-app>

    <script src="../assets/js/vue.js"></script>
    <script src="../assets/js/vuetify.js"></script>
    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    form: true,
                    CurrentDocumentContent: '',
                    QueryText: '',
                    idfCalc: false,
                    tfCalc: false,
                    tdidfCalc: false,

                    wordsList: [],
                    Documents: [],
                    result: [],
                    
                    QueryRule: [
                        v => !!v || 'A Query is required'
                    ],

                    DocumentContentRule: [
                        v => !!v || 'Some content is required',
                        v => (v && v.length >= 5) || 'Document content must be more than 10 characters'
                    ]
                }
            },
            methods: {
                handleNewDoc: function () {
                    //Add to Documents
                    this.Documents.push({
                        Name: `Doc ${this.Documents.length+1}`,
                        Content: this.CurrentDocumentContent
                    })
                    //this returns new array with terms
                    let DocumentWords = this.CurrentDocumentContent.toLowerCase().split(' ')
                    //getting every term out of the array and inserting into bag of words and count dublications
                    DocumentWords.forEach((term) => {
                        let found = false
                        for(var i = 0; i < this.wordsList.length; i++) {
                            if (this.wordsList[i].termName == term) {
                                found = true
                                ++this.wordsList[i].termDublications
                                break
                            }
                        }
                        if (!found) this.wordsList.push({termName:term,termDublications:1,idf:0})
                    })
                    // this.CurrentDocumentName = ''
                    this.CurrentDocumentContent = ''
                    console.log(this.wordsList)
                },
                calc_IDF: function () {
                    let N = this.Documents.length
                    this.wordsList.forEach((term) => {
                        term.idf = Math.log10(N/term.termDublications).toFixed(3)
                    })
                    this.idfCalc = true
                    console.log(this.wordsList)
                }
            }
        })
    </script>
</body>

</html>